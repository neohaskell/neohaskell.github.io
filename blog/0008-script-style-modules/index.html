<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">NHEP 8 - Script-style modules | NeoHaskell</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://neohaskell.org/img/neohaskell-social.png"><meta data-rh="true" name="twitter:image" content="https://neohaskell.org/img/neohaskell-social.png"><meta data-rh="true" property="og:url" content="https://neohaskell.org/blog/0008-script-style-modules"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="NHEP 8 - Script-style modules | NeoHaskell"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-11-08T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/NickSeagull"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://neohaskell.org/blog/0008-script-style-modules"><link data-rh="true" rel="alternate" href="https://neohaskell.org/blog/0008-script-style-modules" hreflang="en"><link data-rh="true" rel="alternate" href="https://neohaskell.org/blog/0008-script-style-modules" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="NeoHaskell RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="NeoHaskell Atom Feed">




<link rel="preconnect" href="https://app.posthog.com">
<script>!function(t,o){var e,p,i,n;o.__SV||(window.posthog=o,o._i=[],o.init=function(r,s,a){function c(t,o){var e=o.split(".");2==e.length&&(t=t[e[0]],o=e[1]),t[o]=function(){t.push([o].concat(Array.prototype.slice.call(arguments,0)))}}(i=t.createElement("script")).type="text/javascript",i.async=!0,i.src=s.api_host+"/static/array.js",(n=t.getElementsByTagName("script")[0]).parentNode.insertBefore(i,n);var g=o;for(void 0!==a?g=o[a]=[]:a="posthog",g.people=g.people||[],g.toString=function(t){var o="posthog";return"posthog"!==a&&(o+="."+a),t||(o+=" (stub)"),o},g.people.toString=function(){return g.toString(1)+".people (stub)"},e="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset".split(" "),p=0;p<e.length;p++)c(g,e[p]);o._i.push([r,s,a])},o.__SV=1)}(document,window.posthog||[]),posthog.init("phc_OV9vt2ooQmPSMBRvLLoeTGpOh5aZTQOrfpDHpqwqRqO",{api_host:"https://app.posthog.com",id:"default"})</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.f73b3cc5.css">
<link rel="preload" href="/assets/js/runtime~main.40a93914.js" as="script">
<link rel="preload" href="/assets/js/main.d77c5c93.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="NeoHaskell Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="NeoHaskell Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">NeoHaskell</b></a><a class="navbar__item navbar__link" href="/docs/docs-intro/">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Evolution Proposals</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/neohaskell/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://discord.com/invite/wDj3UYzec8" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Proposals Index</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/0000-index">NHEP 0 - Index of NeoHaskell Evolution Proposals</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/0001-purpose-and-guidelines">NHEP 1 - Purpose and Guidelines</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/0002-project-target">NHEP 2 - Target and User Persona</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/0003-principles-of-design">NHEP 3 - Principles of Design</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/0004-semantic-versioning">NHEP 4 - Semantic Versioning</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/0005-better-default-string-type">NHEP 5 - Better Default String Type</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/0006-better-default-list-type">NHEP 6 - Better Default List Type</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/0007-more-concise-type-signature-syntax">NHEP 7 - More Concise Type Signature Syntax</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/0008-script-style-modules">NHEP 8 - Script-style modules</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">NHEP 8 - Script-style modules</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-11-08T00:00:00.000Z" itemprop="datePublished">November 8, 2023</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/NickSeagull" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/NickSeagull.png" alt="Nick Tchayka"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/NickSeagull" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nick Tchayka</span></a></div><small class="avatar__subtitle" itemprop="description">Creator of NeoHaskell</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>STATUS - DRAFT</div><div class="admonitionContent_S0QG"></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>Haskell doesn&#x27;t allow writing code directly in a file, with the intent of running it as a script.
Similarly to Java, Rust or C, it forces the user to put the code that is going to be run in a <code>main</code> function.</p><p>Contrary to Java or the others, the syntax is extremely useful for scripts, as it is expressive and concise.
There are solutions like <code>runhaskell</code> that allow you to run a Haskell file that defines a <code>main</code> function,
and users are already using it for scripts. For example, the widely used library <a href="https://github.com/digital-asset/ghc-lib/blob/master/CI.hs" target="_blank" rel="noopener noreferrer">ghc-lib uses it for their CI/CD processes</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="possible-implementation">Possible Implementation<a href="#possible-implementation" class="hash-link" aria-label="Direct link to Possible Implementation" title="Direct link to Possible Implementation">​</a></h2><p>Imports would be parsed and put at the top level, the rest would be inside of a <code>main</code> function. The users would have to run the module&#x27;s <code>main</code> function explicitly, so there are no unexpected side effects on imports.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-with-no-exports">Example with no exports<a href="#example-with-no-exports" class="hash-link" aria-label="Direct link to Example with no exports" title="Direct link to Example with no exports">​</a></h3><div class="language-haskell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9EFEFF;--prism-background-color:#2D2A55"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-haskell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9EFEFF"><span class="token keyword" style="color:rgb(255, 157, 0)">module</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">MyScript</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token import-statement keyword" style="color:rgb(255, 157, 0)">import</span><span class="token import-statement"> File</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">foo</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">File</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token builtin" style="color:rgb(250, 208, 0)">read</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;foo.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">myFunction</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">Int</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">-&gt;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">String</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">myFunction</span><span class="token plain"> </span><span class="token hvariable">n</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">Int</span><span class="token hvariable punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token hvariable">toString</span><span class="token plain"> </span><span class="token hvariable">n</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">+</span><span class="token plain"> </span><span class="token hvariable">foo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This would be compiled to:</p><div class="language-haskell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9EFEFF;--prism-background-color:#2D2A55"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-haskell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9EFEFF"><span class="token keyword" style="color:rgb(255, 157, 0)">module</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">MyScript</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token import-statement keyword" style="color:rgb(255, 157, 0)">import</span><span class="token import-statement"> File</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">main</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">foo</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">File</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token builtin" style="color:rgb(250, 208, 0)">read</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;foo.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">myFunction</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">Int</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">-&gt;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">String</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">myFunction</span><span class="token plain"> </span><span class="token hvariable">n</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token hvariable">Int</span><span class="token hvariable punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token hvariable">toString</span><span class="token plain"> </span><span class="token hvariable">n</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">+</span><span class="token plain"> </span><span class="token hvariable">foo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">pass</span><span class="token plain">    </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">-- This is a function that does nothing but is required to make the main function valid</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-with-exports">Example with exports<a href="#example-with-exports" class="hash-link" aria-label="Direct link to Example with exports" title="Direct link to Example with exports">​</a></h3><p>The complexity is exporting symbols. If one would want to export some kind of function or data type from this kind of module, those would have to be put at the top level, which means that they wouldn&#x27;t be allowed to use stuff from the scope they&#x27;re defined with. E.g.</p><div class="language-haskell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9EFEFF;--prism-background-color:#2D2A55"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-haskell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9EFEFF"><span class="token keyword" style="color:rgb(255, 157, 0)">module</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">MyScript</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token hvariable">myFunction</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token import-statement keyword" style="color:rgb(255, 157, 0)">import</span><span class="token import-statement"> File</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">foo</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">File</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token builtin" style="color:rgb(250, 208, 0)">read</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;foo.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">myFunction</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">Int</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">-&gt;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">String</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">myFunction</span><span class="token plain"> </span><span class="token hvariable">n</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">Int</span><span class="token hvariable punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token hvariable">toString</span><span class="token plain"> </span><span class="token hvariable">n</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">+</span><span class="token plain"> </span><span class="token hvariable">foo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This would be compiled to:</p><div class="language-haskell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9EFEFF;--prism-background-color:#2D2A55"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-haskell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9EFEFF"><span class="token keyword" style="color:rgb(255, 157, 0)">module</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">MyScript</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token hvariable">myFunction</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> </span><span class="token hvariable">main</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token import-statement keyword" style="color:rgb(255, 157, 0)">import</span><span class="token import-statement"> File</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">myFunction</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">Int</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">-&gt;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">String</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">myFunction</span><span class="token plain"> </span><span class="token hvariable">n</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">Int</span><span class="token hvariable punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token hvariable">toString</span><span class="token plain"> </span><span class="token hvariable">n</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">+</span><span class="token plain"> </span><span class="token hvariable">foo</span><span class="token plain">     </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">-- Woops, foo is not defined!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">main</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">foo</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">File</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token builtin" style="color:rgb(250, 208, 0)">read</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;foo.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">pass</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A solution would be to have a compile-time marker that marks the function as reexported in a script-style module, and if it has a <code>&lt;symbol&gt;  is not in scope</code> error, tell that it is not allowed to do that kind of stuff because it is introducing side effects, and we would direct the user to the proper documentation that explains why not.</p><p>Another solution, which is a double-edged blade, is to do some symbol tracking and if the function has to be reexported to the top level, we create a top-level mutable reference that:</p><ol><li>Is <strong>NOT</strong> reexported</li><li>Is initialized in <code>main</code></li><li>The function does an unsafe read of the mutable reference, using that value.</li></ol><p>This has the problem that if <code>main</code> hasn&#x27;t been called, this would fail in runtime.</p><p>A naive solution would be to introduce a runtime check, but that would make the code slower, and we&#x27;d introduce a
runtime error that would be hard to debug, which goes against the principles of NeoHaskell.</p><p>A possibility would be to have another compile-time check, that would disallow the usage of the function if the
<code>main</code> function of that module hasn&#x27;t been called yet. Still, that is a complex task to implement, as we&#x27;d have to
figure out a way to track that, especially when branching is introduced, or even when concurrency is at play.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="impact-on-principle-of-least-astonishment">Impact on Principle of Least Astonishment<a href="#impact-on-principle-of-least-astonishment" class="hash-link" aria-label="Direct link to Impact on Principle of Least Astonishment" title="Direct link to Impact on Principle of Least Astonishment">​</a></h2><p>Most languages nowadays allow writing scripts directly in a file, so it would not be surprising for users to be able to do that in NeoHaskell.</p><p>On the other hand, having the separation between the import and the module initialization is something not common at
all in other languages, so it is a very alien thing unless we manage to find a way to make it more familiar.</p><p>A possibility here could be that script-style modules are not allowed to export anything, as they are scripts,
meant to be run directly, and not imported.</p><p>Also, another possibility would be to have main to return a record of functions, as scripts do not return anything.
(They can print stuff, and write to files, but they do not return anything, apart from an exit code).</p><p>This could introduce a powerful tool for defining services, as the service initialization would be done in the main
function and the service would be returned as a record of functions, which would be the API of the service:</p><div class="language-haskell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9EFEFF;--prism-background-color:#2D2A55"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-haskell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9EFEFF"><span class="token keyword" style="color:rgb(255, 157, 0)">module</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">ProductService</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">count</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">deleteById</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token import-statement keyword" style="color:rgb(255, 157, 0)">import</span><span class="token import-statement"> File</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token import-statement keyword" style="color:rgb(255, 157, 0)">import</span><span class="token import-statement"> Env</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">dbFile</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">Env</span><span class="token hvariable punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token hvariable">get</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;DB_FILE&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">          </span><span class="token operator" style="color:rgb(255, 157, 0)">|&gt;</span><span class="token plain"> </span><span class="token hvariable">orElse</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;db.sqlite&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">tableName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">Env</span><span class="token hvariable punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token hvariable">get</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;TABLE_NAME&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">             </span><span class="token operator" style="color:rgb(255, 157, 0)">|&gt;</span><span class="token plain"> </span><span class="token hvariable">orElse</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;products&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">db</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">File</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token builtin" style="color:rgb(250, 208, 0)">read</span><span class="token plain"> </span><span class="token hvariable">dbFile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">count</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">IO</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">Int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">count</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">deleteById</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">UUID</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">-&gt;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">IO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">deleteById</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(250, 208, 0)">id</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we wrapped everything into a function named <code>init</code> making it compile to the following, it would enable
a very interesting pattern for defining services:</p><div class="language-haskell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9EFEFF;--prism-background-color:#2D2A55"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-haskell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9EFEFF"><span class="token keyword" style="color:rgb(255, 157, 0)">module</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">ProductService</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">count</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">deleteById</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token keyword" style="color:rgb(255, 157, 0)">data</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">ProductService</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">ProductService</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">count</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">IO</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">Int</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">deleteById</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">UUID</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">-&gt;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">IO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token builtin" style="color:rgb(250, 208, 0)">init</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">IO</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">ProductService</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token builtin" style="color:rgb(250, 208, 0)">init</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">dbFile</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">Env</span><span class="token hvariable punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token hvariable">get</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;DB_FILE&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">            </span><span class="token operator" style="color:rgb(255, 157, 0)">|&gt;</span><span class="token plain"> </span><span class="token hvariable">orElse</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;db.sqlite&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">tableName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">Env</span><span class="token hvariable punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token hvariable">get</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;TABLE_NAME&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">               </span><span class="token operator" style="color:rgb(255, 157, 0)">|&gt;</span><span class="token plain"> </span><span class="token hvariable">orElse</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">&quot;products&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">db</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">File</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token builtin" style="color:rgb(250, 208, 0)">read</span><span class="token plain"> </span><span class="token hvariable">dbFile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">count</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">IO</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">Int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">count</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">deleteById</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">UUID</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">-&gt;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">IO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">deleteById</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(250, 208, 0)">id</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">yield</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">ProductService</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token hvariable">count</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">    </span><span class="token hvariable">deleteById</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So now, some code that would use this service could do the following:</p><div class="language-haskell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9EFEFF;--prism-background-color:#2D2A55"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-haskell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9EFEFF"><span class="token import-statement keyword" style="color:rgb(255, 157, 0)">import</span><span class="token import-statement"> ProductService</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token hvariable">main</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token builtin" style="color:rgb(250, 208, 0)">product</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">ProductService</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token builtin" style="color:rgb(250, 208, 0)">init</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">totalProducts</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;-</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(250, 208, 0)">product</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token hvariable">count</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token builtin" style="color:rgb(250, 208, 0)">print</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token hvariable">Int</span><span class="token hvariable punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token hvariable">toString</span><span class="token plain"> </span><span class="token hvariable">totalProducts</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Perhaps, at this point, it&#x27;d make sense to introduce a new keyword for defining services, instead of
relying on <code>module</code>? Maybe <code>service</code>?</p><div class="language-haskell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9EFEFF;--prism-background-color:#2D2A55"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-haskell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9EFEFF"><span class="token hvariable">service</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">ProductService</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">count</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain">  </span><span class="token hvariable">deleteById</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9EFEFF"><span class="token plain"></span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">-- and so on...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="impact-on-principle-of-developer-happiness">Impact on Principle of Developer Happiness<a href="#impact-on-principle-of-developer-happiness" class="hash-link" aria-label="Direct link to Impact on Principle of Developer Happiness" title="Direct link to Impact on Principle of Developer Happiness">​</a></h2><p>Many technologies allow the use of the same language as a way of configuring the application/project, for example,
in Ruby they use the language itself to define project dependencies or even the specification of the project.
<a href="https://github.com/rails/rails/blob/main/rails.gemspec" target="_blank" rel="noopener noreferrer">Here&#x27;s the gemspec file of Ruby on Rails</a>.</p><p>On the other hand, instead of writing scripts with Bash, Python or Ruby, one could use NeoHaskell, which is a much
more powerful language, and it would allow the user to use the same language for everything. Nowadays, people
are using Python in an &quot;explorative&quot; manner, where they write scripts and keep tweaking them until they get the
desired result, and then they put that into their application.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="impact-on-principle-of-least-effort">Impact on Principle of Least Effort<a href="#impact-on-principle-of-least-effort" class="hash-link" aria-label="Direct link to Impact on Principle of Least Effort" title="Direct link to Impact on Principle of Least Effort">​</a></h2><p>This removes the necessity of having to write a <code>main</code> function, which is a very small thing, but it is still
something that the user has to do, and it is not something that is needed in other languages.</p><p>On the other hand, this does introduce many implementation tasks in the NeoHaskell codebase, so it is not something
that can be done in a short amount of time.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col margin-top--sm"><a href="https://github.com/neohaskell/nhep/edit/main/nhep/0008-script-style-modules/index.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/0007-more-concise-type-signature-syntax"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">NHEP 7 - More Concise Type Signature Syntax</div></a></nav><div></div></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#possible-implementation" class="table-of-contents__link toc-highlight">Possible Implementation</a><ul><li><a href="#example-with-no-exports" class="table-of-contents__link toc-highlight">Example with no exports</a></li><li><a href="#example-with-exports" class="table-of-contents__link toc-highlight">Example with exports</a></li></ul></li><li><a href="#impact-on-principle-of-least-astonishment" class="table-of-contents__link toc-highlight">Impact on Principle of Least Astonishment</a></li><li><a href="#impact-on-principle-of-developer-happiness" class="table-of-contents__link toc-highlight">Impact on Principle of Developer Happiness</a></li><li><a href="#impact-on-principle-of-least-effort" class="table-of-contents__link toc-highlight">Impact on Principle of Least Effort</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/docs-intro">Get Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.com/invite/wDj3UYzec8" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/neohaskell" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/neohaskell" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 NeoHaskell contributors</div></div></div></footer></div>
<script src="/assets/js/runtime~main.40a93914.js"></script>
<script src="/assets/js/main.d77c5c93.js"></script>
</body>
</html>